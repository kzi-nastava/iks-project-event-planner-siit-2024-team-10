<div class="outer-container">
  <div class="register-container">
    <form [formGroup]="createForm" class="elegant-form">
      <div class="form-header">
        <h1>Create event</h1>
      </div>
      <mat-checkbox formControlName="noEventType" color="primary">No event types apply</mat-checkbox>
      <mat-form-field *ngIf="eventTypesDisplayed()">
        <mat-label>Event Type</mat-label>
        <mat-select formControlName="eventType">
          @for (eventType of allEventTypes; track eventType) {
            <mat-option [value]="eventType">{{eventType.name}}</mat-option>
          }
        </mat-select>
      </mat-form-field>
      
      <mat-form-field appearance="outline">
        <mat-label>Name</mat-label>
        <input matInput formControlName="name" name="name">
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Description</mat-label>
        <textarea matInput formControlName="description" rows="3"></textarea>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Max participants</mat-label>
        <input matInput formControlName="maxParticipants" name="maxParticipants">
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Country</mat-label>
        <input matInput formControlName="country" name="country">
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>City</mat-label>
        <input matInput formControlName="city" name="city">
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Street</mat-label>
        <input matInput formControlName="street" name="street">
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>House number</mat-label>
        <input matInput formControlName="houseNumber" name="houseNumber">
      </mat-form-field>
      <mat-form-field>
        <mat-label>Choose a date</mat-label>
        <input [min]="today" formControlName="date" matInput [matDatepicker]="picker">
        <mat-hint>MM/DD/YYYY</mat-hint>
        <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
      </mat-form-field>
      <mat-button-toggle-group name="eventPublicity" aria-label="Font Style" formControlName="eventPublicity">
        <mat-button-toggle value="open">Open</mat-button-toggle>
        <mat-button-toggle value="closed">Closed</mat-button-toggle>
      </mat-button-toggle-group>

      <div *ngIf="recommendedCategories.length > 0">
        <h3>Budget Items</h3>
        <button mat-raised-button color="primary" (click)="addBudgetItem()">Add Budget Item</button>
      
        <div formArrayName="budgetItems" class="budget-items-container">
          <div *ngFor="let group of budgetItemsFormArray.controls; let i = index" [formGroupName]="i" class="budget-item-form">
            <mat-form-field appearance="outline">
              <mat-label>Category</mat-label>
              <mat-select formControlName="category">
                <mat-option *ngFor="let cat of recommendedCategories" [value]="cat">
                  {{ cat.name }}
                </mat-option>
              </mat-select>
            </mat-form-field>
      
            <mat-form-field appearance="outline">
              <mat-label>Planned Amount (RSD)</mat-label>
              <input matInput type="number" formControlName="amount">
            </mat-form-field>
          </div>
        </div>
      </div>
      
      <button mat-flat-button class="submit-btn"  (click)="save()">
        Submit
      </button>
    </form>
  </div>
</div>
